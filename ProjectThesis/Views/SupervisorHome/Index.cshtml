@model ProjectThesis.ViewModels.SupervisorPanelViewModel
@{
    ViewData["Title"] = "HomeSupervisor";
    Layout = "_SupervisorHomeLayout";
}

<div class="row">
    <div class="col-12">
        <p class="text-danger text-center">@TempData["Error"]</p>
        <p class="text-success text-center">@TempData["Success"]</p>
    </div>
</div>

<div id="thesisList" style="width: 100%; height: 100%">
    @foreach (var student in Model.Students)
    {
        <h3>@student.ChosenThesis.Subject</h3>
        <p>@student.User.FirstName @student.User.LastName @student.User.Email @student.StudentNo</p>
        <a class="btn btn-danger" asp-controller="SupervisorHome" asp-action="RemoveStudent" asp-route-thesisId="@student.ChosenThesis.Id">Odsuń studenta od tematu</a>
    }
    <br />
    <h2>Pozostałe prace:</h2>
    @foreach (var thesis in Model.ThesesNotChosen)
    {
        <form asp-controller="SupervisorHome" asp-action="removeThesis" id="RemoveThesisForm">
            <div class="form-group">
                <h4>@thesis.Subject</h4>
                <button type="button" id="remove-thesis-button" value=@thesis.Id onclick="removeThesis(this.value)" data-toggle="modal" data-target="#confirm-removing-subject" class="btn btn-danger">Usuń temat</button>
                <button type="button" id=@thesis.Id onclick="changeThesis(this.id)" class="btn btn-primary">Edytuj temat</button>
            </div>
        </form>
    }
</div>

<form asp-controller="SupervisorHome" asp-action="changeThesis" id="changeThesForm" style="display: none; text-align: center; left: 25%; width: 50%; height: 100%; top: 35%; position: fixed; background: white;">
    <div class="d-flex flex-row" style="width: 100%; width: 100%;">
        <div class="form-group" style="width: 100%;">
            <label>Podaj temat</label>
            <input require type="text" name="thesisSubject" class="form-control">
            <button type="button" data-toggle="modal" data-target="#confirm-changing-subject" id="changeThesButton" name="thesisId" class="btn btn-primary" style="text-align:center; margin-right: 5px; margin-top: 10px;">Zapisz temat</button>
            <button type="button" class="btn btn-secondary" onclick="showThesis()" style="text-align:center; margin-top: 10px;">Powrót</button>
        </div>
    </div>
</form>

<div id="confirm-removing-subject" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Potwierdzenie usunięcia tematu</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Czy jesteś pewien, że chcesz usunąć ten temat?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="confirmRemoveButton">Tak</button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">Nie</button>
            </div>
        </div>
    </div>
</div>

<div id="confirm-changing-subject" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Potwierdzenie zmiany teamtu</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Czy jesteś pewien, że chcesz zmienić temat na "<span class="text-primary" id="thesis-title"></span>"?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="confirmChangeButton">Tak</button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">Nie</button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    
    $('#changeThesButton').click(function () {
        $('#thesis-title').text($('input[name="thesisSubject"]').val());
    });

    $('#confirmChangeButton').click(function () {
        $('input[name="thesisSubject"]').val($("#changeThesButton").attr('value') + " " + $('input[name="thesisSubject"]').val());
        $('#changeThesForm').submit();
    });

    
    function removeThesis(value) {
        $('#confirmRemoveButton').attr('value', value);

    }

    $('#confirmRemoveButton').click(function () {
        $('#RemoveThesisForm').append('<input type="hidden" id="additional-input" name="thesisId" value="'
            + $(this).attr('value') + '" /> ');
        $('#RemoveThesisForm').submit();
    });

    function changeThesis(id) {

        $("#changeThesButton").attr('value', id);
        $('#changeThesForm').show();
        $('#thesisList').hide();
    }

    function showThesis() {

        $('#changeThesForm').hide();
        $('#thesisList').show();
    }

</script>